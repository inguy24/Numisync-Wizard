<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NumiSync Wizard - User Manual</title>
  <style>
    :root {
      --primary: #2c3e50;
      --accent: #3498db;
      --accent-dark: #2980b9;
      --bg: #ffffff;
      --bg-alt: #f8f9fa;
      --bg-code: #f4f4f4;
      --border: #dee2e6;
      --text: #333333;
      --text-light: #666666;
      --green: #27ae60;
      --yellow: #f39c12;
      --orange: #e67e22;
      --red: #e74c3c;
      --sidebar-width: 300px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: var(--text);
      line-height: 1.7;
      background: var(--bg);
    }

    /* ── Sidebar / Table of Contents ── */
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: var(--sidebar-width);
      height: 100vh;
      overflow-y: auto;
      background: var(--primary);
      color: #ecf0f1;
      padding: 20px 0;
      z-index: 100;
      transition: transform 0.3s;
    }

    .sidebar h2 {
      font-size: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
      padding: 0 20px 15px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      margin-bottom: 10px;
    }

    .sidebar ul { list-style: none; }

    .sidebar > ul > li > a {
      display: block;
      padding: 8px 20px;
      color: #bdc3c7;
      text-decoration: none;
      font-size: 14px;
      font-weight: 600;
      transition: background 0.2s, color 0.2s;
    }

    .sidebar > ul > li > a:hover,
    .sidebar > ul > li > a.active {
      background: rgba(255,255,255,0.08);
      color: #ffffff;
    }

    .sidebar ul ul { padding-left: 0; }

    .sidebar ul ul li a {
      display: block;
      padding: 5px 20px 5px 36px;
      color: #95a5a6;
      text-decoration: none;
      font-size: 13px;
      transition: background 0.2s, color 0.2s;
    }

    .sidebar ul ul li a:hover {
      background: rgba(255,255,255,0.05);
      color: #ecf0f1;
    }

    /* ── Toggle button for mobile ── */
    .sidebar-toggle {
      display: none;
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 200;
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 12px;
      font-size: 18px;
      border-radius: 4px;
      cursor: pointer;
    }

    @media (max-width: 900px) {
      .sidebar { transform: translateX(-100%); }
      .sidebar.open { transform: translateX(0); }
      .sidebar-toggle { display: block; }
      .main-content { margin-left: 0 !important; }
    }

    /* ── Main Content ── */
    .main-content {
      margin-left: var(--sidebar-width);
      padding: 40px 60px 80px;
      max-width: 960px;
    }

    /* ── Typography ── */
    h1 {
      font-size: 32px;
      color: var(--primary);
      margin-bottom: 8px;
      padding-bottom: 12px;
      border-bottom: 3px solid var(--accent);
    }

    .subtitle {
      font-size: 16px;
      color: var(--text-light);
      margin-bottom: 40px;
    }

    h2 {
      font-size: 24px;
      color: var(--primary);
      margin-top: 50px;
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--border);
      scroll-margin-top: 20px;
    }

    h3 {
      font-size: 18px;
      color: var(--primary);
      margin-top: 30px;
      margin-bottom: 10px;
      scroll-margin-top: 20px;
    }

    h4 {
      font-size: 15px;
      color: var(--text);
      margin-top: 20px;
      margin-bottom: 8px;
      scroll-margin-top: 20px;
    }

    p { margin-bottom: 12px; }

    ul, ol {
      margin: 8px 0 16px 24px;
    }

    li { margin-bottom: 6px; }

    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }

    /* ── Tables ── */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0 24px;
      font-size: 14px;
    }

    th, td {
      text-align: left;
      padding: 10px 14px;
      border: 1px solid var(--border);
    }

    th {
      background: var(--primary);
      color: white;
      font-weight: 600;
    }

    tr:nth-child(even) { background: var(--bg-alt); }

    /* ── Code / Inline ── */
    code {
      background: var(--bg-code);
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 13px;
      font-family: 'Consolas', 'Courier New', monospace;
    }

    pre {
      background: var(--bg-code);
      padding: 16px;
      border-radius: 6px;
      overflow-x: auto;
      margin: 12px 0 20px;
      font-size: 13px;
      line-height: 1.5;
      border: 1px solid var(--border);
    }

    pre code { background: none; padding: 0; }

    /* ── Callout boxes ── */
    .callout {
      padding: 16px 20px;
      border-radius: 6px;
      margin: 16px 0 20px;
      border-left: 4px solid;
    }

    .callout-info {
      background: #eaf4fc;
      border-color: var(--accent);
    }

    .callout-warning {
      background: #fef9e7;
      border-color: var(--yellow);
    }

    .callout-danger {
      background: #fdedec;
      border-color: var(--red);
    }

    .callout-success {
      background: #eafaf1;
      border-color: var(--green);
    }

    .callout strong { display: block; margin-bottom: 4px; }

    /* ── Status badge ── */
    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 3px;
      font-size: 12px;
      font-weight: 600;
      color: white;
    }

    .badge-green { background: var(--green); }
    .badge-yellow { background: var(--yellow); }
    .badge-orange { background: var(--orange); }
    .badge-red { background: var(--red); }
    .badge-gray { background: #95a5a6; }

    /* ── Keyboard key styling ── */
    kbd {
      background: var(--bg-alt);
      border: 1px solid var(--border);
      border-radius: 3px;
      padding: 2px 6px;
      font-size: 12px;
      font-family: 'Consolas', monospace;
      box-shadow: 0 1px 0 rgba(0,0,0,0.1);
    }

    /* ── Screenshot placeholder ── */
    .screenshot {
      background: var(--bg-alt);
      border: 2px dashed var(--border);
      border-radius: 8px;
      padding: 30px;
      text-align: center;
      color: var(--text-light);
      margin: 16px 0;
      font-style: italic;
    }

    /* ── Step-by-step instructions ── */
    .steps { counter-reset: step; list-style: none; margin-left: 0; }
    .steps li {
      counter-increment: step;
      padding: 12px 0 12px 50px;
      position: relative;
      border-bottom: 1px solid var(--border);
    }
    .steps li:last-child { border-bottom: none; }
    .steps li::before {
      content: counter(step);
      position: absolute;
      left: 0;
      top: 12px;
      width: 32px;
      height: 32px;
      background: var(--accent);
      color: white;
      border-radius: 50%;
      text-align: center;
      line-height: 32px;
      font-weight: 700;
      font-size: 14px;
    }

    /* ── Back to top ── */
    .back-to-top {
      display: block;
      text-align: right;
      font-size: 13px;
      margin-top: 30px;
      color: var(--accent);
    }

    /* ── Horizontal rule ── */
    hr {
      border: none;
      border-top: 1px solid var(--border);
      margin: 40px 0;
    }

    /* ── Print styles ── */
    @media print {
      .sidebar, .sidebar-toggle, .back-to-top { display: none !important; }
      .main-content { margin-left: 0; padding: 20px; max-width: 100%; }
      h2 { page-break-before: always; }
      h2:first-of-type { page-break-before: avoid; }
    }
  </style>
</head>
<body>

<!-- Mobile sidebar toggle -->
<button class="sidebar-toggle" onclick="document.querySelector('.sidebar').classList.toggle('open')">&#9776; Menu</button>

<!-- ════════════════════════════════════════════════════════════════════════ -->
<!-- SIDEBAR / TABLE OF CONTENTS                                            -->
<!-- ════════════════════════════════════════════════════════════════════════ -->
<nav class="sidebar">
  <h2>User Manual</h2>
  <ul>
    <li><a href="#introduction">1. Introduction</a>
      <ul>
        <li><a href="#what-is">What Is This Tool?</a></li>
        <li><a href="#key-concepts">Key Concepts</a></li>
        <li><a href="#system-requirements">System Requirements</a></li>
      </ul>
    </li>
    <li><a href="#getting-started">2. Getting Started</a>
      <ul>
        <li><a href="#installation">Installation</a></li>
        <li><a href="#api-key">Getting a Numista API Key</a></li>
        <li><a href="#first-launch">First Launch &amp; Setup</a></li>
      </ul>
    </li>
    <li><a href="#loading-collection">3. Loading a Collection</a>
      <ul>
        <li><a href="#open-db">Opening a Database File</a></li>
        <li><a href="#collection-overview">Collection Overview</a></li>
        <li><a href="#progress-summary">Progress Summary &amp; Info Bar</a></li>
      </ul>
    </li>
    <!-- Closing a Collection is in Section 16 -->
    <li><a href="#data-settings">4. Data Settings</a>
      <ul>
        <li><a href="#data-types">Data Types Explained</a></li>
        <li><a href="#currency-selection">Currency Selection</a></li>
        <li><a href="#search-category">Search Category Filter</a></li>
        <li><a href="#api-cost">API Call Costs</a></li>
      </ul>
    </li>
    <li><a href="#enriching-coins">5. Enriching Coins</a>
      <ul>
        <li><a href="#workflow-overview">Workflow Overview</a></li>
        <li><a href="#automatic-search">Automatic Search</a></li>
        <li><a href="#manual-search">Manual Search</a></li>
        <li><a href="#confidence-scores">Confidence Scores</a></li>
        <li><a href="#selecting-match">Selecting a Match</a></li>
        <li><a href="#skipping-coins">Skipping Coins</a></li>
      </ul>
    </li>
    <li><a href="#field-comparison">6. Field Comparison</a>
      <ul>
        <li><a href="#reviewing-fields">Reviewing Fields</a></li>
        <li><a href="#selection-tools">Selection Tools</a></li>
        <li><a href="#image-comparison">Image Comparison</a></li>
        <li><a href="#applying-changes">Applying Changes</a></li>
      </ul>
    </li>
    <li><a href="#issue-matching">7. Issue Matching</a>
      <ul>
        <li><a href="#auto-matching">Automatic Matching</a></li>
        <li><a href="#issue-picker">Issue Picker Modal</a></li>
      </ul>
    </li>
    <li><a href="#pricing">8. Pricing Data</a>
      <ul>
        <li><a href="#pricing-grades">Pricing Grades</a></li>
        <li><a href="#freshness-tracking">Freshness Tracking</a></li>
        <li><a href="#fast-pricing">Fast Pricing Mode</a></li>
        <li><a href="#auto-propagate">Auto-Propagate</a></li>
      </ul>
    </li>
    <li><a href="#filtering-sorting">9. Filtering &amp; Sorting</a>
      <ul>
        <li><a href="#status-filters">Status Filters</a></li>
        <li><a href="#freshness-filters">Freshness Filters</a></li>
        <li><a href="#sort-options">Sort Options</a></li>
        <li><a href="#filter-summary">Filter Summary</a></li>
        <li><a href="#pagination">Pagination</a></li>
      </ul>
    </li>
    <li><a href="#status-tracking">10. Status Tracking</a>
      <ul>
        <li><a href="#coin-statuses">Coin Statuses</a></li>
        <li><a href="#data-status-icons">Data Status Icons</a></li>
        <li><a href="#metadata-persistence">Metadata Persistence</a></li>
      </ul>
    </li>
    <li><a href="#images">11. Image Handling</a>
      <ul>
        <li><a href="#image-display">Image Display</a></li>
        <li><a href="#image-lightbox">Image Lightbox</a></li>
        <li><a href="#image-modes">Storage Modes</a></li>
      </ul>
    </li>
    <li><a href="#settings-reference">12. Settings Reference</a>
      <ul>
        <li><a href="#default-collection">Default Collection</a></li>
        <li><a href="#api-key-setting">API Key</a></li>
        <li><a href="#search-settings">Search Settings</a></li>
        <li><a href="#image-settings">Image Handling</a></li>
        <li><a href="#safety-settings">Safety &amp; Backups</a></li>
        <li><a href="#license-settings">License Management</a></li>
      </ul>
    </li>
    <li><a href="#backups">13. Backups &amp; Safety</a></li>
    <li><a href="#status-bar">14. Status Bar</a></li>
    <li><a href="#keyboard-shortcuts">15. Menu Bar &amp; Shortcuts</a>
      <ul>
        <li><a href="#menu-file">File Menu</a></li>
        <li><a href="#menu-edit">Edit Menu</a></li>
        <li><a href="#menu-view">View Menu</a></li>
        <li><a href="#menu-settings">Settings Menu</a></li>
        <li><a href="#menu-help">Help Menu</a></li>
        <li><a href="#other-shortcuts">Other Shortcuts</a></li>
      </ul>
    </li>
    <li><a href="#closing-collection">16. Closing a Collection</a></li>
    <li><a href="#troubleshooting">17. Troubleshooting</a></li>
    <li><a href="#getting-help">18. Getting Help</a></li>
    <li><a href="#faq">19. FAQ</a></li>
    <li><a href="#api-cache-usage">20. API Cache &amp; Usage</a>
      <ul>
        <li><a href="#cache-overview">Cache Overview</a></li>
        <li><a href="#cache-settings">Cache Settings</a></li>
        <li><a href="#monthly-usage">Monthly Usage Tracking</a></li>
        <li><a href="#numista-quota">Numista API Quota</a></li>
      </ul>
    </li>
    <li><a href="#appendix-fields">Appendix A: Field Reference</a></li>
    <li><a href="#appendix-statuses">Appendix B: Status Reference</a></li>
  </ul>
</nav>

<!-- ════════════════════════════════════════════════════════════════════════ -->
<!-- MAIN CONTENT                                                           -->
<!-- ════════════════════════════════════════════════════════════════════════ -->
<div class="main-content">

<!-- ──────────────────────────────────────────────────────────────────────── -->
<div style="text-align: center; margin-bottom: 10px;">
  <img src="../src/renderer/images/logo_with_text.svg" alt="NumiSync Wizard for OpenNumismat" style="height: 110px; width: auto;">
</div>
<p class="subtitle">Complete User Manual &mdash; v1.1</p>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="introduction">1. Introduction</h2>

<h3 id="what-is">What Is This Tool?</h3>
<p>
  The <strong>NumiSync Wizard</strong> is a desktop application that enhances your
  <a href="https://opennumismat.github.io/" target="_blank">OpenNumismat</a> coin collection
  with comprehensive data from the
  <a href="https://en.numista.com/" target="_blank">Numista</a> online coin database.
</p>
<p>
  It allows you to search Numista for each coin in your collection, compare the data side-by-side,
  and selectively import fields such as descriptions, specifications, catalog numbers, mintage
  figures, and current market prices &mdash; all while keeping full control over what gets written
  to your database.
</p>

<h3 id="key-concepts">Key Concepts</h3>
<ul>
  <li><strong>OpenNumismat</strong> &mdash; A free, open-source coin collecting application that stores your collection in an SQLite <code>.db</code> file.</li>
  <li><strong>Numista</strong> &mdash; A large online database of coins from around the world, with a public API for searching and retrieving coin data.</li>
  <li><strong>Enrichment</strong> &mdash; The process of filling in or updating fields in your OpenNumismat database with authoritative data from Numista.</li>
  <li><strong>Coin Type</strong> &mdash; A general coin design (e.g., "1 Penny, George V"). Multiple issues (years, mints) share one type.</li>
  <li><strong>Issue</strong> &mdash; A specific striking of a coin type in a particular year, at a particular mint, with a particular mintage.</li>
  <li><strong>API Key</strong> &mdash; A personal key that grants access to the Numista API. Free for personal use.</li>
  <li><strong>API Call</strong> &mdash; Each request to the Numista servers. The tool tracks how many calls you make per session.</li>
</ul>

<h3 id="system-requirements">System Requirements</h3>
<table>
  <tr><th>Requirement</th><th>Details</th></tr>
  <tr><td>Operating System</td><td>Windows 10/11, macOS 10.15+, or Linux</td></tr>
  <tr><td>OpenNumismat</td><td>Any version that produces a standard <code>.db</code> collection file</td></tr>
  <tr><td>Internet Connection</td><td>Required for Numista API access</td></tr>
  <tr><td>Numista Account</td><td>Free account needed to obtain an API key</td></tr>
</table>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="getting-started">2. Getting Started</h2>

<h3 id="installation">Installation</h3>
<p>Download the appropriate installer for your operating system and run it. The application installs as a standard desktop application.</p>

<h3 id="api-key">Getting a Numista API Key</h3>
<p>Before you can search and enrich coins, you need a free API key from Numista:</p>
<ol class="steps">
  <li>Go to <a href="https://en.numista.com/" target="_blank">numista.com</a> and create a free account (or log in if you already have one).</li>
  <li>Visit the <a href="https://en.numista.com/api/" target="_blank">Numista API page</a>.</li>
  <li>Generate your personal API key.</li>
  <li>Copy the key &mdash; you will paste it into the tool's Settings screen.</li>
</ol>

<div class="callout callout-info">
  <strong>Note:</strong>
  The Numista API key is free for personal use. It allows you to search and retrieve coin data for your own collection.
</div>

<h3 id="first-launch">First Launch &amp; Setup</h3>
<ol class="steps">
  <li>Launch the application. On first launch, the <strong>End User License Agreement (EULA)</strong> will appear. Read the terms and click <strong>I Accept</strong> to continue. You must accept the EULA to use the application.</li>
  <li>You will see the <strong>Welcome screen</strong> with the application logo and version information.</li>
  <li>Open <strong>Settings</strong> &rarr; <strong>App Settings</strong> from the menu bar (or press <kbd>Ctrl</kbd>+<kbd>,</kbd>).</li>
  <li>Paste your Numista API key into the <strong>API Key</strong> field.</li>
  <li>Review the default settings (they work well for most users) and click <strong>Save Settings</strong>.</li>
  <li>Click <strong>Close</strong> to return to the Welcome screen. You are now ready to load a collection.</li>
</ol>

<div class="callout callout-info">
  <strong>EULA:</strong>
  You can review the End User License Agreement at any time by selecting <strong>Help</strong> &rarr; <strong>View EULA</strong> from the menu bar.
</div>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="loading-collection">3. Loading a Collection</h2>

<h3 id="open-db">Opening a Database File</h3>
<p>
  From the Welcome screen, click <strong>Load Collection</strong>. A file dialog will appear &mdash;
  navigate to your OpenNumismat <code>.db</code> file and select it.
</p>
<p>
  The tool reads the database and loads up to <strong>10,000 coins</strong>. A progress bar shows loading status.
  Settings specific to this collection are stored alongside the database in a file named
  <code>&lt;database&gt;_settings.json</code>.
</p>

<div class="callout callout-info">
  <strong>Tip:</strong>
  If you have previously enriched coins from this collection, the tool automatically detects and restores
  your progress from metadata stored in each coin's notes field.
</div>

<h3 id="collection-overview">Collection Overview</h3>
<p>
  After loading, the <strong>Collection Overview</strong> screen displays all coins in a scrollable list or grid.
  The <strong>application header</strong> updates to show:
</p>
<ul>
  <li><strong>Collection Title</strong> &mdash; The database filename, displayed in the center of the header</li>
  <li><strong>Fast Pricing Mode</strong> &mdash; Button to enter batch pricing update mode (Supporter Edition feature)</li>
  <li><strong>Close Collection</strong> &mdash; Button to return to the welcome screen</li>
</ul>
<p>Each coin entry in the list shows:</p>
<ul>
  <li><strong>Thumbnail images</strong> &mdash; Obverse and reverse (if available in your database)</li>
  <li><strong>Title</strong> &mdash; The coin's name</li>
  <li><strong>Details</strong> &mdash; Country, year, denomination</li>
  <li><strong>Status icons</strong> &mdash; Three icons showing the state of Basic [B], Issue [I], and Pricing [P] data</li>
</ul>

<h3 id="progress-summary">Progress Summary &amp; Info Bar</h3>
<p>
  Below the header, an <strong>Info Bar Card</strong> displays your collection statistics and filter controls
  in a unified panel. This card contains:
</p>
<ul>
  <li><strong>Progress stats</strong> &mdash; Total coin count and progress bars for Basic, Issue, and Pricing data</li>
  <li><strong>Status summary</strong> &mdash; Counts for Complete, Partial, Unprocessed, and Skipped coins</li>
  <li><strong>Pricing summary</strong> &mdash; Counts grouped by pricing freshness (Current, Recent, Aging, Outdated, Never)</li>
  <li><strong>Filter controls</strong> &mdash; Dropdowns for filtering and sorting, plus view mode toggle (list/grid)</li>
</ul>

<h4>Pinning the Info Bar</h4>
<p>
  A small <strong>thumbtack icon</strong> appears in the top-left corner of the Info Bar Card (the "dog-ear" corner).
  Click this icon to <strong>pin</strong> or <strong>unpin</strong> the info bar:
</p>
<ul>
  <li><strong>Unpinned (default):</strong> The info bar scrolls with the coin list. The thumbtack appears slanted.</li>
  <li><strong>Pinned:</strong> The info bar stays fixed at the top while you scroll through coins. The thumbtack rotates to vertical, indicating it's "pushed in."</li>
</ul>
<p>This preference is saved per-collection, so each collection remembers your choice.</p>

<h4>Progress Statistics</h4>
<p>The stats section summarizes your enrichment progress per data type:</p>
<table>
  <tr><th>Card</th><th>Meaning</th></tr>
  <tr><td><strong>Total Coins</strong></td><td>Number of coins in your collection</td></tr>
  <tr><td><strong>Basic Data</strong></td><td>Shows how many coins have basic type data merged out of the total (e.g., "42 / 521"), with a blue progress bar</td></tr>
  <tr><td><strong>Issue Data</strong></td><td>Shows how many coins have issue-specific data (mintmark, mintage) merged, with a blue progress bar</td></tr>
  <tr><td><strong>Pricing Data</strong></td><td>Shows how many coins have pricing data merged, with a blue progress bar</td></tr>
</table>
<p>Each data-type card also displays a secondary line with error and skipped counts when either is greater than zero. Error counts appear in <strong style="color: #dc2626;">red</strong> to draw attention. These counts are clickable &mdash; clicking an error count filters the coin list to show coins missing that data type, and clicking a skipped count filters to skipped coins.</p>
<p>All three data-type cards are always visible regardless of which data types are currently enabled in Data Settings, giving you a complete view of your collection's enrichment status at all times.</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="data-settings">4. Data Settings</h2>

<p>
  With a collection open, click the <strong>gear icon (&#9881;)</strong> in the header and select
  <strong>Data Settings</strong> to configure what data the tool fetches for each coin.
  This opens a modal dialog with toggle options.
</p>

<h3 id="data-types">Data Types Explained</h3>

<h4>Basic Data (2 API calls)</h4>
<p>Core information about the coin type:</p>
<ul>
  <li>Title, category, series</li>
  <li>Country (issuer), period, ruler</li>
  <li>Denomination (value and unit)</li>
  <li>Material composition, weight, diameter, thickness, shape</li>
  <li>Physical specifications (orientation, minting technique)</li>
  <li>Descriptions (obverse, reverse, edge, lettering)</li>
  <li>Catalog numbers (KM, Sch&ouml;n, Y, etc.)</li>
</ul>

<h4>Issue Data (+1 API call)</h4>
<p>Mint-specific information for the exact year and mint of your coin:</p>
<ul>
  <li>Mintmark (mint letter, e.g., "D" for Denver)</li>
  <li>Mintage (number of coins struck)</li>
  <li>Comment (e.g., "Proof", special designations)</li>
</ul>

<div class="callout callout-warning">
  <strong>Important:</strong>
  Issue matching requires that your coin has a year recorded. If multiple issues exist for that year
  (different mints, proof vs. regular), you may be asked to select the correct one.
</div>

<h4>Pricing Data (+1 API call)</h4>
<p>Current market values in your chosen currency, across four grade levels:</p>
<ul>
  <li>Uncirculated (UNC)</li>
  <li>Extremely Fine (XF)</li>
  <li>Very Fine (VF)</li>
  <li>Fine (F)</li>
</ul>
<p>Prices include a timestamp so you can track how current they are (see <a href="#freshness-tracking">Freshness Tracking</a>).</p>

<h3 id="currency-selection">Currency Selection</h3>
<p>When Pricing Data is enabled, choose from seven supported currencies:</p>
<table>
  <tr><th>Code</th><th>Currency</th></tr>
  <tr><td>USD</td><td>US Dollar</td></tr>
  <tr><td>EUR</td><td>Euro</td></tr>
  <tr><td>GBP</td><td>British Pound</td></tr>
  <tr><td>CAD</td><td>Canadian Dollar</td></tr>
  <tr><td>AUD</td><td>Australian Dollar</td></tr>
  <tr><td>JPY</td><td>Japanese Yen</td></tr>
  <tr><td>CHF</td><td>Swiss Franc</td></tr>
</table>

<h3 id="search-category">Search Category Filter</h3>
<p>
  The Data Settings modal includes a <strong>Search Category</strong> dropdown that filters what type of
  items to search for on Numista:
</p>
<table>
  <tr><th>Category</th><th>Description</th></tr>
  <tr><td><strong>Coins</strong> (default)</td><td>Standard circulating and commemorative coins</td></tr>
  <tr><td><strong>Banknotes</strong></td><td>Paper currency and polymer notes</td></tr>
  <tr><td><strong>Exonumia</strong></td><td>Tokens, medals, and other coin-like objects</td></tr>
</table>
<p>
  If your collection contains non-coin items (such as tokens or medals), selecting the appropriate
  category improves search accuracy by filtering out irrelevant results.
</p>

<h3 id="api-cost">API Call Costs</h3>
<p>The Data Settings modal shows how many API calls will be made per coin based on your selections:</p>
<table>
  <tr><th>Selection</th><th>Calls Per Coin</th></tr>
  <tr><td>Basic Data only</td><td>2 calls</td></tr>
  <tr><td>Basic + Issue</td><td>3 calls</td></tr>
  <tr><td>Basic + Pricing</td><td>3 calls</td></tr>
  <tr><td>Basic + Issue + Pricing</td><td>4 calls</td></tr>
</table>
<p>The session call counter in the status bar tracks your total API usage during the current session.</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="enriching-coins">5. Enriching Coins</h2>

<h3 id="workflow-overview">Workflow Overview</h3>
<p>
  The enrichment process works one coin at a time for maximum accuracy. The general flow is:
</p>
<ol class="steps">
  <li><strong>Click a coin</strong> in the Collection Overview to begin enriching it.</li>
  <li><strong>Review search results</strong> &mdash; The tool automatically searches Numista and shows matching coin types ranked by confidence.</li>
  <li><strong>Select the correct match</strong> &mdash; Click the result that matches your coin.</li>
  <li><strong>Compare fields</strong> &mdash; Review a side-by-side comparison of your data vs. Numista data.</li>
  <li><strong>Choose fields to import</strong> &mdash; Check the boxes for the fields you want to update.</li>
  <li><strong>Apply changes</strong> &mdash; The selected fields are written to your database.</li>
</ol>

<h3 id="automatic-search">Automatic Search</h3>
<p>
  When you click a coin, the tool builds a search query from your coin's existing data (title, year,
  country, denomination) and sends it to the Numista API. Denomination unit spellings are automatically
  normalized for better results &mdash; for example, if your coin says &ldquo;Kopeks&rdquo;, the search
  uses &ldquo;Kopecks&rdquo; (Numista&rsquo;s preferred spelling). Up to <strong>20 matches</strong> are
  returned and displayed as cards.
</p>
<p>Each match card shows:</p>
<ul>
  <li>Coin type title</li>
  <li>Country (issuer)</li>
  <li>Date range (e.g., 1911&ndash;1936)</li>
  <li>Confidence score (0&ndash;100%)</li>
</ul>

<h3 id="manual-search">Manual Search</h3>
<p>
  If the automatic search does not find a good match, click <strong>Try Different Search</strong>
  to open the Manual Search panel. Enter custom search terms in the text field and click
  <strong>Search</strong> (or press <kbd>Enter</kbd>).
</p>
<p><strong>Search tips:</strong></p>
<ul>
  <li>Try shorter terms: <code>1 Penny 1912</code> instead of the full title</li>
  <li>Try denomination and year: <code>Penny 1912</code></li>
  <li>Try the ruler's name: <code>George V</code></li>
  <li>Try a catalog number: <code>KM 23</code></li>
  <li>Try country and year: <code>Australia 1912</code></li>
</ul>

<div class="callout callout-info">
  <strong>Tip:</strong>
  You can also click <strong>Search Again</strong> to retry the automatic search &mdash; useful if
  you've edited the coin's data in OpenNumismat since the last search.
</div>

<h3 id="confidence-scores">Confidence Scores</h3>
<p>
  Each search result is assigned a confidence score based on how well it matches your coin's data.
  The score considers title similarity, year overlap, country match, denomination, and catalog numbers.
  Denomination matching uses an alias normalizer that recognizes over 100 denomination families
  and their spelling variants (e.g., &ldquo;Kopeks&rdquo; matches &ldquo;Kopeck&rdquo;,
  &ldquo;Pfenning&rdquo; matches &ldquo;Pfennig&rdquo;, &ldquo;Rouble&rdquo; matches &ldquo;Ruble&rdquo;),
  so confidence scores are accurate even when your collection uses different spellings than Numista.
</p>
<table>
  <tr><th>Score Range</th><th>Color</th><th>Meaning</th></tr>
  <tr><td>70&ndash;100%</td><td><span class="badge badge-green">Green</span></td><td>Strong match &mdash; likely correct</td></tr>
  <tr><td>40&ndash;69%</td><td><span class="badge badge-yellow">Yellow</span></td><td>Possible match &mdash; review carefully</td></tr>
  <tr><td>0&ndash;39%</td><td><span class="badge badge-red">Red</span></td><td>Weak match &mdash; probably not correct</td></tr>
</table>

<h3 id="selecting-match">Selecting a Match</h3>
<p>
  Click on any search result card to select it. The tool then fetches detailed data for that coin
  type from Numista (using the API calls configured in Data Settings) and takes you to the
  <a href="#field-comparison">Field Comparison</a> screen.
</p>

<h3 id="skipping-coins">Skipping Coins</h3>
<p>
  If none of the results match your coin, or you don't want to enrich this coin right now,
  click <strong>Skip This Coin</strong>. The coin is marked as "Skipped" in your collection
  and you return to the Collection Overview.
</p>
<p>You can return to a skipped coin later and try again at any time.</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="field-comparison">6. Field Comparison &amp; Selection</h2>

<h3 id="reviewing-fields">Reviewing Fields</h3>
<p>
  The Field Comparison screen shows a side-by-side view of your current data alongside the
  Numista data. Each row represents one field (e.g., "Weight", "Composition", "Obverse Description").
</p>
<ul>
  <li>Fields where your data <strong>differs</strong> from Numista are shown in <strong>bold</strong>.</li>
  <li>Fields where your data is <strong>empty</strong> and Numista has a value are highlighted &mdash; these are prime candidates for import.</li>
  <li>Fields are grouped by data type: Basic Data, Issue Data, and Pricing Data (depending on your settings).</li>
  <li>The <strong>Mint</strong> field is automatically resolved to the correct mint facility based on the mint letter
    (from issue data or your coin's mintmark). When this differs from your current value, it is
    <strong>pre-checked</strong> for your convenience &mdash; you can uncheck it if you disagree.</li>
</ul>

<h3 id="selection-tools">Selection Tools</h3>
<p>Four quick-selection buttons help you efficiently choose fields:</p>
<table>
  <tr><th>Button</th><th>Action</th></tr>
  <tr><td><strong>Select All</strong></td><td>Checks every field</td></tr>
  <tr><td><strong>Select None</strong></td><td>Unchecks every field</td></tr>
  <tr><td><strong>Select Empty Only</strong></td><td>Checks only fields where your database has no value</td></tr>
  <tr><td><strong>Select Different Only</strong></td><td>Checks only fields where the Numista value differs from yours</td></tr>
</table>

<div class="callout callout-success">
  <strong>Recommended approach:</strong>
  Use <strong>Select Empty Only</strong> to fill gaps in your data without overwriting anything you've
  already entered. Then manually check any additional fields you want to update.
</div>

<h3 id="image-comparison">Image Comparison</h3>
<p>
  Image fields (<code>obverseimg</code>, <code>reverseimg</code>, <code>edgeimg</code>) display inline image previews
  directly in the field row, just like other data fields:
</p>
<ul>
  <li><strong>Current column</strong> &mdash; Shows your coin's existing image from the database (or a placeholder if none).</li>
  <li><strong>Numista column</strong> &mdash; Shows the reference image from Numista (or a placeholder if unavailable).</li>
</ul>
<p>
  Images display at 80&times;80px with hover-to-zoom (2.5&times;) and lightbox click support. Check the checkbox
  next to an image field to replace your image with Numista's image. When you click <strong>Apply Changes</strong>,
  selected images are automatically downloaded and stored in your database.
</p>

<h3 id="applying-changes">Applying Changes</h3>
<p>
  Once you've selected the fields you want, click <strong>Apply Changes to Coin</strong>.
</p>
<p>The tool will:</p>
<ol>
  <li>Create an automatic backup of your database (if enabled in Settings).</li>
  <li>Write the selected field values to your coin's record in the database.</li>
  <li>If any image fields were selected, download the images from Numista and store them in the database.</li>
  <li>Store enrichment metadata in the coin's notes field (invisible to OpenNumismat users).</li>
  <li>Update the coin's status to "Merged".</li>
  <li>Return you to the Collection Overview with the coin's status updated.</li>
</ol>

<p>Click <strong>Cancel</strong> to return to the Match Selection screen without making changes.</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="issue-matching">7. Issue Matching</h2>

<p>
  When you have Issue Data enabled in your Data Settings, the tool attempts to match your specific
  coin to the correct <em>issue</em> (a particular year, mint, and type within a coin type).
</p>

<h3 id="auto-matching">Automatic Matching</h3>
<p>The tool uses a smart multi-step algorithm to find the right issue:</p>
<ol>
  <li><strong>Filter by year</strong> &mdash; Only issues matching your coin's year are considered. For coins with non-Gregorian dating (e.g., Japanese Meiji, Islamic Hijri, Thai Buddhist), both the era-specific year and the Gregorian equivalent are checked.</li>
  <li><strong>Filter by mintmark</strong> &mdash; If mintmarks vary across issues and your coin has one, further narrow the results.</li>
  <li><strong>Filter by type</strong> &mdash; If there are still multiple matches (e.g., regular vs. Proof), filter by comment/type.</li>
  <li><strong>Result:</strong>
    <ul>
      <li>If exactly <strong>one match</strong> remains &rarr; automatically selected.</li>
      <li>If <strong>multiple matches</strong> remain &rarr; the Issue Picker modal opens.</li>
      <li>If <strong>no matches</strong> &rarr; status set to "No Match".</li>
    </ul>
  </li>
</ol>

<h3 id="issue-picker">Issue Picker Modal</h3>
<p>
  When the automatic matching cannot determine a single issue, a modal dialog appears showing:
</p>
<ul>
  <li><strong>Your coin's details</strong> &mdash; Year, mintmark, type, and thumbnail images (obverse and reverse) for visual reference.</li>
  <li><strong>All candidate issues</strong> &mdash; Listed with year, mintmark, mintage, and any type/comment information. Issues are sorted by match quality, with the best matches shown first.</li>
  <li><strong>Match indicators</strong> &mdash; Visual badges showing "Exact Match" or "Partial Match" for each field.</li>
  <li><strong>Section headers</strong> &mdash; When there are both exact and partial matches, section headers help distinguish "Best matches" from "Other options".</li>
  <li><strong>Issue images</strong> &mdash; Where available, issue-specific images are shown. Hover over images to enlarge them 4&times;.</li>
</ul>

<div class="callout callout-info">
  <strong>Viewing on Numista:</strong>
  A "View on Numista" link appears in the Issue Picker header, allowing you to open the coin type page
  on Numista for additional research before making your selection.
</div>

<p>Select the correct issue using the radio buttons, then click <strong>Apply Selection</strong>.</p>
<p>
  If you're unsure or don't want issue data for this coin, click <strong>Skip Issue Data</strong>.
  The basic data will still be imported; only the issue-specific fields will be skipped.
</p>

<h4>Mintmark Matching</h4>
<p>The issue picker handles mintmark matching intelligently:</p>
<ul>
  <li>If your coin has no mintmark, issues with no mintmark are prioritized and shown as "Exact Match".</li>
  <li>Mintmark variations (e.g., "D" vs "Denver") are normalized for accurate matching.</li>
  <li>Issues from other mints are still shown as "Other options" in case you need to select one.</li>
</ul>

<h4>Mint Name Resolution</h4>
<p>
  The Numista API returns <em>all</em> mints that ever produced a coin type (e.g., Philadelphia, Denver,
  San Francisco, West Point for a US cent). Rather than blindly picking the first mint in the list,
  NumiSync resolves the correct mint using the mint letter:
</p>
<ol>
  <li><strong>Issue data</strong> &mdash; If issue data is available, the <code>mint_letter</code> from the selected issue is used (most accurate).</li>
  <li><strong>Coin mintmark</strong> &mdash; If issue data is not available, your coin's mintmark from the database is used as a fallback.</li>
</ol>
<p>
  The resolution uses multiple strategies: direct letter matching, city-name map lookups (e.g., "D" &rarr; Denver),
  and parenthetical letter matching (e.g., "Monnaie de Paris (A)"). When the mint is successfully resolved and
  differs from your current value, it is <strong>pre-checked</strong> in the comparison screen. If no confident
  match can be made, the first mint in the list is used as a fallback.
</p>

<h4>Denomination Matching</h4>
<p>Denomination units are normalized for both search and scoring:</p>
<ul>
  <li>Spelling variants are automatically mapped to a common form (e.g., &ldquo;Kopeks&rdquo; &rarr; &ldquo;Kopecks&rdquo;, &ldquo;Pfenning&rdquo; &rarr; &ldquo;Pfennig&rdquo;, &ldquo;Rouble&rdquo; &rarr; &ldquo;Ruble&rdquo;).</li>
  <li>Plural forms are preserved in search queries since Numista&rsquo;s search is sensitive to singular vs. plural.</li>
  <li>Over 100 denomination families are covered, including transliterations from Russian, Greek, Arabic, and other scripts.</li>
  <li>Unrecognized denominations fall back to fuzzy string matching so they still work &mdash; just without alias normalization.</li>
</ul>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="pricing">8. Pricing Data</h2>

<h3 id="pricing-grades">Pricing Grades</h3>
<p>When Pricing Data is enabled, the tool fetches current market values in four standard numismatic grades:</p>
<table>
  <tr><th>Grade</th><th>Abbreviation</th><th>Description</th></tr>
  <tr><td>Uncirculated</td><td>UNC</td><td>No wear from circulation; may have minor bag marks</td></tr>
  <tr><td>Extremely Fine</td><td>XF / EF</td><td>Very slight wear on highest points only</td></tr>
  <tr><td>Very Fine</td><td>VF</td><td>Light to moderate wear; all major features sharp</td></tr>
  <tr><td>Fine</td><td>F</td><td>Moderate to heavy even wear; all design elements visible</td></tr>
</table>
<p>Prices are returned from Numista in your selected currency.</p>

<h3 id="freshness-tracking">Freshness Tracking</h3>
<p>
  Coin prices change over time. The tool tracks <em>when</em> pricing data was last fetched
  and categorizes it by age:
</p>
<table>
  <tr><th>Icon</th><th>Category</th><th>Age</th></tr>
  <tr><td><span class="badge badge-green">&#x1F7E2;</span></td><td>Current</td><td>Less than 3 months old</td></tr>
  <tr><td><span class="badge badge-yellow">&#x1F7E1;</span></td><td>Recent</td><td>3 months to 1 year old</td></tr>
  <tr><td><span class="badge badge-orange">&#x1F7E0;</span></td><td>Aging</td><td>1 to 2 years old</td></tr>
  <tr><td><span class="badge badge-red">&#x1F534;</span></td><td>Outdated</td><td>More than 2 years old</td></tr>
  <tr><td><span class="badge badge-gray">&#x26AA;</span></td><td>Never Updated</td><td>No pricing data fetched</td></tr>
</table>
<p>Freshness is displayed as a colored icon on the [P] status indicator in the coin list.</p>

<h3 id="fast-pricing">Fast Pricing Mode <span class="badge" style="background: linear-gradient(135deg, #d4af37, #f4e4ba); color: #333;">PREMIUM</span></h3>
<p>
  <strong>Fast Pricing Mode</strong> is a premium feature that allows you to refresh pricing data for
  multiple coins at once &mdash; without needing to re-search or re-match each coin. This is ideal for
  batch-updating outdated prices across your collection.
</p>

<div class="callout callout-info">
  <strong>Premium Feature:</strong>
  Fast Pricing Mode requires a Supporter Edition license. Free users can still update pricing by
  clicking individual coins and re-applying changes with Pricing Data enabled.
</div>

<h4>Eligibility</h4>
<p>A coin is eligible for fast pricing update if it has:</p>
<ul>
  <li>A <strong>Numista Type ID</strong> stored in its metadata (from previous enrichment)</li>
  <li>A <strong>Numista Issue ID</strong> stored in its metadata (from previous issue matching)</li>
</ul>
<p>Coins without both IDs cannot be fast-updated because issue-specific pricing requires the exact issue to be known.</p>

<h4>Using Fast Pricing Mode</h4>
<ol class="steps">
  <li>Click the <strong>Fast Pricing Mode</strong> button in the Collection Overview toolbar. The button shows a lock icon if you don't have a Supporter license.</li>
  <li>The interface enters Fast Pricing Mode: checkboxes appear next to eligible coins, and a selection toolbar appears.</li>
  <li>Select coins to update:
    <ul>
      <li><strong>Select All Eligible</strong> &mdash; Selects all eligible coins in the entire collection</li>
      <li><strong>Select Displayed</strong> &mdash; Selects only eligible coins on the current page</li>
      <li><strong>Clear</strong> &mdash; Deselects all coins</li>
      <li>Click individual checkboxes to toggle selection</li>
    </ul>
  </li>
  <li>Click <strong>Update Pricing</strong>. A confirmation dialog shows the number of coins and estimated time.</li>
  <li>Click <strong>Start Update</strong>. A progress indicator appears in the status bar.</li>
  <li>As each coin is processed, its row shows visual feedback:
    <ul>
      <li><span style="color: var(--green);">Green highlight</span> &mdash; Pricing updated successfully</li>
      <li><span style="color: var(--red);">Red highlight</span> &mdash; Update failed (e.g., API error)</li>
    </ul>
  </li>
  <li>When complete, a summary modal shows results. Successfully updated coins are deselected; failed coins remain selected for easy retry.</li>
  <li>Click <strong>Exit Mode</strong> to return to normal view.</li>
</ol>

<h4>Rate Limiting &amp; Backups</h4>
<ul>
  <li>Fast pricing respects Numista's API rate limit (1 call per second).</li>
  <li>A single backup is created before the batch starts (not per-coin) to minimize disk usage.</li>
  <li>You can click <strong>Cancel</strong> during processing to stop after the current coin completes.</li>
</ul>

<h4>Tips for Fast Pricing</h4>
<ul>
  <li>Use the <strong>Pricing Freshness</strong> filter set to "Outdated" or "Aging" to find coins that need price updates.</li>
  <li>The toolbar shows counts: "Selected: 15 / Eligible: 42" to help track your selection.</li>
  <li>Row highlights persist after the batch completes, making it easy to see results while scrolling through pages.</li>
</ul>

<h3 id="auto-propagate">Auto-Propagate <span class="badge" style="background: linear-gradient(135deg, #d4af37, #f4e4ba); color: #333;">PREMIUM</span></h3>
<p>
  <strong>Auto-Propagate</strong> is a premium feature that automatically detects other coins in your
  collection that share the same Numista type as the coin you just enriched. It offers to apply the
  same type-level data to all matching coins at once &mdash; saving you time and API calls.
</p>

<div class="callout callout-info">
  <strong>Premium Feature:</strong>
  Detecting matching coins is FREE for all users. Applying data to multiple coins requires a Supporter Edition license.
  Free users can still enrich each coin individually using the normal workflow.
</div>

<h4>How It Works</h4>
<ol class="steps">
  <li>Enrich a coin as normal &mdash; search, select match, choose fields, and click <strong>Apply Selected Fields</strong>.</li>
  <li>After the merge completes, the system automatically searches your collection for coins with matching catalog numbers or Numista IDs.</li>
  <li>If matches are found, a prompt appears showing two categories:
    <ul>
      <li><strong>True Duplicates</strong> &mdash; Coins with the same type, year, AND mintmark. These can receive ALL data (type + issue + pricing).</li>
      <li><strong>Same Type, Different Issue</strong> &mdash; Coins of the same type but different year or mintmark. These receive type-level data only (title, material, weight, catalog numbers, etc.).</li>
    </ul>
  </li>
  <li>Choose an action:
    <ul>
      <li><strong>Apply to This Coin Only</strong> &mdash; Skip propagation (free)</li>
      <li><strong>Apply to All</strong> &mdash; Propagate data to all matching coins (premium)</li>
    </ul>
  </li>
  <li>If you choose "Apply to All," a progress bar shows the batch operation status.</li>
  <li>When complete, a results summary shows how many coins were updated and any that were skipped.</li>
</ol>

<h4>What Data Gets Propagated</h4>
<table>
  <tr><th>Coin Category</th><th>Data Applied</th></tr>
  <tr><td><strong>True Duplicates</strong></td><td>All selected fields: type data, issue data (mintage), and pricing data</td></tr>
  <tr><td><strong>Same Type, Different Issue</strong></td><td>Type-level data only: title, material, weight, diameter, catalog numbers, images, etc.</td></tr>
</table>
<p>Issue-specific data (mintage, pricing) is NOT applied to coins with different years or mintmarks because those values would be incorrect.</p>

<h4>Matching Criteria</h4>
<p>Coins are considered "matching" if they have:</p>
<ul>
  <li><strong>Same Numista ID</strong> in their metadata (from previous enrichment) &mdash; this is the most definitive match</li>
  <li><strong>Matching catalog numbers</strong> &mdash; ALL populated catalog slots (KM#, Sch&ouml;n#, etc.) must match</li>
</ul>
<p>If any catalog number conflicts, the coin is NOT considered a match (strict matching for safety).</p>

<h4>Skipped Coins</h4>
<p>Some coins may be skipped for issue/pricing data if:</p>
<ul>
  <li>They have a different year than the enriched coin</li>
  <li>They have a different mintmark</li>
  <li>The issue has distinguishing features (privy marks, signatures) that OpenNumismat cannot track</li>
</ul>
<p>These coins still receive type-level data. The results summary shows skip reasons so you can enrich them individually if needed.</p>

<h4>Disabling Auto-Propagate</h4>
<p>
  If you prefer not to see the propagation prompt after each enrichment:
</p>
<ol>
  <li>Open <strong>Settings</strong> &rarr; <strong>Data Settings</strong>.</li>
  <li>Uncheck <strong>Enable Auto-Propagate</strong>.</li>
  <li>Click <strong>Save Settings</strong>.</li>
</ol>
<p>With this setting disabled, enrichments complete silently without showing the matching coins prompt.</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="filtering-sorting">9. Filtering &amp; Sorting</h2>

<p>
  The Collection Overview provides powerful filtering and sorting controls to help you navigate
  large collections and focus on the coins that need attention.
</p>

<h3 id="status-filters">Status Filters</h3>
<p>The <strong>Show</strong> dropdown filters coins by their enrichment status:</p>
<table>
  <tr><th>Filter</th><th>Shows</th></tr>
  <tr><td><strong>All Coins</strong></td><td>Every coin in the collection (default)</td></tr>
  <tr><td><strong>Unprocessed Only</strong></td><td>Coins that have not been enriched or skipped</td></tr>
  <tr><td><strong>Merged (Basic Data)</strong></td><td>Coins with basic data successfully imported</td></tr>
  <tr><td><strong>Skipped</strong></td><td>Coins you chose to skip</td></tr>
  <tr><td colspan="2" style="background: var(--bg-alt); font-weight: 600;">Completeness</td></tr>
  <tr><td><strong>Complete (All Data)</strong></td><td>Coins with all requested data types successfully merged</td></tr>
  <tr><td><strong>Partial (Missing Some Data)</strong></td><td>Coins where some data types succeeded and others failed or were skipped</td></tr>
  <tr><td colspan="2" style="background: var(--bg-alt); font-weight: 600;">Missing Data</td></tr>
  <tr><td><strong>Missing Basic Data</strong></td><td>Coins without basic type data</td></tr>
  <tr><td><strong>Missing Issue Data</strong></td><td>Coins without issue-specific data (mintmark, mintage)</td></tr>
  <tr><td><strong>Missing Pricing Data</strong></td><td>Coins without pricing information</td></tr>
</table>

<h3 id="freshness-filters">Freshness Filters</h3>
<p>The <strong>Pricing Freshness</strong> dropdown filters coins by the age of their pricing data:</p>
<table>
  <tr><th>Filter</th><th>Shows</th></tr>
  <tr><td><strong>All Ages</strong></td><td>All coins regardless of pricing age (default)</td></tr>
  <tr><td><strong>Current (&lt; 3 months)</strong></td><td>Coins with very recent pricing</td></tr>
  <tr><td><strong>Recent (3mo &ndash; 1yr)</strong></td><td>Coins with reasonably current pricing</td></tr>
  <tr><td><strong>Aging (1&ndash;2 years)</strong></td><td>Coins with pricing that may need updating</td></tr>
  <tr><td><strong>Outdated (&gt; 2 years)</strong></td><td>Coins with stale pricing that should be refreshed</td></tr>
  <tr><td><strong>Never Updated</strong></td><td>Coins that have never had pricing data fetched</td></tr>
</table>

<h3 id="sort-options">Sort Options</h3>
<p>The <strong>Sort by</strong> dropdown controls the order of the coin list:</p>
<table>
  <tr><th>Option</th><th>Order</th></tr>
  <tr><td><strong>Title</strong></td><td>Alphabetical by coin title (default)</td></tr>
  <tr><td><strong>Year</strong></td><td>Chronological by year</td></tr>
  <tr><td><strong>Country</strong></td><td>Alphabetical by country/issuer</td></tr>
  <tr><td><strong>Status</strong></td><td>By enrichment status (complete &rarr; partial &rarr; unprocessed)</td></tr>
  <tr><td><strong>Last Updated</strong></td><td>Most recently enriched coins first</td></tr>
  <tr><td><strong>Pricing Freshness</strong></td><td>Oldest pricing first (so you can prioritize updates)</td></tr>
</table>

<p>Click <strong>Reset Filters</strong> to return all filters and sorting to their default values.</p>

<h3 id="filter-summary">Filter Summary</h3>
<p>
  When a filter is active, a summary bar appears below the filter controls showing count statistics
  for each filter category. This gives you a quick overview of your collection's enrichment status.
</p>

<h3 id="pagination">Pagination</h3>
<p>
  Large collections are paginated at <strong>100 coins per page</strong>. Navigation controls appear
  above the coin list:
</p>
<table>
  <tr><th>Button</th><th>Action</th></tr>
  <tr><td>&#x23EE;&#xFE0F; First</td><td>Jump to the first page</td></tr>
  <tr><td>&#x25C0;&#xFE0F; Previous</td><td>Go back one page</td></tr>
  <tr><td>&#x25B6;&#xFE0F; Next</td><td>Go forward one page</td></tr>
  <tr><td>&#x23ED;&#xFE0F; Last</td><td>Jump to the last page</td></tr>
</table>
<p>The page indicator shows your current position (e.g., "Page 3 of 12").</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="status-tracking">10. Status Tracking</h2>

<h3 id="coin-statuses">Coin Statuses</h3>
<p>
  Each coin has an overall status as well as individual statuses for each data type (Basic, Issue, Pricing).
</p>

<h4>Overall Coin Status</h4>
<table>
  <tr><th>Status</th><th>Meaning</th></tr>
  <tr><td><strong>Complete</strong></td><td>All requested data types have been successfully merged</td></tr>
  <tr><td><strong>Partial</strong></td><td>Some data types merged, but others failed or were skipped</td></tr>
  <tr><td><strong>Pending</strong></td><td>Coin has not been processed yet</td></tr>
  <tr><td><strong>Skipped</strong></td><td>User chose to skip this coin entirely</td></tr>
  <tr><td><strong>Error</strong></td><td>A critical failure occurred during processing</td></tr>
</table>

<h3 id="data-status-icons">Data Status Icons</h3>
<p>In the coin list, three icons ([B] [I] [P]) indicate the status of each data type:</p>
<table>
  <tr><th>Icon</th><th>Status</th><th>Meaning</th></tr>
  <tr><td>&#x2705;</td><td>Merged</td><td>Data successfully imported from Numista</td></tr>
  <tr><td>&#x26AA;</td><td>Not Queried</td><td>This data type was not requested in settings</td></tr>
  <tr><td>&#x23F3;</td><td>Pending</td><td>Currently being fetched</td></tr>
  <tr><td>&#x274C;</td><td>Error</td><td>API call failed for this data type</td></tr>
  <tr><td>&#x2753;</td><td>No Match</td><td>Issue matching failed (Issue data only)</td></tr>
  <tr><td>&#x1F4ED;</td><td>No Data</td><td>Numista returned no results for this data type</td></tr>
  <tr><td>&#x1F6AB;</td><td>Skipped</td><td>User chose to skip this data type</td></tr>
</table>

<div class="callout callout-info">
  <strong>Tooltips:</strong>
  Hover over any status icon in the coin list to see a tooltip describing its current state
  and, for pricing icons, the freshness age of the data.
</div>

<h3 id="metadata-persistence">Metadata Persistence</h3>
<p>
  Enrichment progress is stored directly inside your OpenNumismat database as an invisible HTML comment
  in each coin's <code>note</code> field. This means:
</p>
<ul>
  <li><strong>Progress survives reinstalls</strong> &mdash; Reinstalling the tool does not lose your work.</li>
  <li><strong>Progress travels with the database</strong> &mdash; Copy your <code>.db</code> file anywhere and the enrichment data goes with it.</li>
  <li><strong>Your notes are preserved</strong> &mdash; Any personal notes you've written in the Notes field are untouched; the metadata is appended as a hidden comment.</li>
  <li><strong>OpenNumismat compatibility</strong> &mdash; The metadata is invisible when viewing coins in OpenNumismat.</li>
</ul>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="images">11. Image Handling</h2>

<h3 id="image-display">Image Display</h3>
<p>Images appear throughout the application at various sizes with interactive zoom features:</p>
<table>
  <tr><th>Context</th><th>Size</th><th>Interaction</th></tr>
  <tr><td>Coin list (Collection Overview)</td><td>40 &times; 40 px</td><td>Lazy-loaded thumbnails</td></tr>
  <tr><td>Match Selection (your coin)</td><td>60 &times; 60 px</td><td>Hover to zoom 3&times;, click for lightbox</td></tr>
  <tr><td>Field Comparison (image fields)</td><td>80 &times; 80 px</td><td>Hover to zoom 2.5&times;, click for lightbox</td></tr>
  <tr><td>Issue Picker</td><td>50 &times; 50 px</td><td>Hover to zoom 4&times;</td></tr>
</table>
<p>Obverse, reverse, and edge images are shown where available. Coins without images display a placeholder (labeled OBV, REV, or EDGE).</p>

<h4 id="image-lightbox">Image Lightbox</h4>
<p>
  Click on any coin image in the Match Selection or Field Comparison screens to open it in a
  <strong>lightbox</strong> view. The lightbox displays the image at full size (up to the screen dimensions)
  in a darkened overlay. Click anywhere or press <kbd>Escape</kbd> to close the lightbox.
</p>
<p>This is useful for examining fine details like mintmarks, date variations, or design elements.</p>

<h3 id="image-modes">How Images Are Stored</h3>
<p>
  When you select image fields (obverseimg, reverseimg, edgeimg) during field comparison and click
  <strong>Apply Changes</strong>, images are automatically downloaded from Numista and stored directly
  in your OpenNumismat database:
</p>
<ul>
  <li>Images are downloaded at full resolution from the Numista CDN.</li>
  <li>Stored as binary data (BLOBs) in the <code>photos</code> table.</li>
  <li>Works offline &mdash; no internet needed to view images in OpenNumismat after enrichment.</li>
  <li>Each image adds approximately 50-500 KB to your database size (varies by image).</li>
</ul>
<p>
  If Numista doesn't have an image for a particular coin side (obverse, reverse, or edge), a placeholder
  will be shown in the field comparison and no image will be downloaded for that field.
</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="settings-reference">12. Settings Reference</h2>

<p>
  NumiSync Wizard has two categories of settings, accessible from the <strong>gear icon (&#9881;)</strong> dropdown in the top-right corner of the application header:
</p>
<ul>
  <li><strong>App Settings</strong> (<kbd>Ctrl</kbd>+<kbd>,</kbd>) &mdash; API key, backup preferences, default collection, and license management. Always available.</li>
  <li><strong>Data Settings</strong> &mdash; Which data types to fetch and currency selection (see <a href="#data-settings">Section 4</a>). Only visible when a collection is open.</li>
</ul>
<p>
  Click the gear icon to reveal the dropdown menu, then select the settings category you want to configure.
  You can also access settings from the application menu bar under <strong>Settings</strong> (Windows) or
  <strong>Preferences</strong> (macOS).
</p>
<p>
  Settings are saved per-collection in a <code>&lt;database&gt;_settings.json</code> file stored in the same
  directory as your database.
</p>

<div class="callout callout-info">
  <strong>Settings File Location:</strong>
  If your database is at <code>C:\Coins\MyCollection.db</code>, settings are saved to
  <code>C:\Coins\MyCollection.db_settings.json</code>. If you move or copy your database
  to another location, copy the settings file alongside it to preserve your configuration.
  If the settings file is missing or deleted, the application uses default values and you
  will need to re-enter your API key.
</div>

<h3 id="default-collection">Default Collection</h3>
<p>
  You can designate one collection to automatically load when the application starts:
</p>
<ul>
  <li><strong>Set as Default:</strong> With a collection open, select <strong>File</strong> &rarr; <strong>Set as Default Collection</strong></li>
  <li><strong>Clear Default:</strong> Select <strong>File</strong> &rarr; <strong>Clear Default Collection</strong></li>
</ul>
<p>
  The default collection setting is also shown in App Settings where you can browse for a different database
  or clear the setting.
</p>

<h3 id="api-key-setting">API Key</h3>
<table>
  <tr><th>Setting</th><th>Details</th></tr>
  <tr><td><strong>Numista API Key</strong></td><td>Your personal API key from Numista. Required for all operations. Stored securely as a password field.</td></tr>
</table>

<h3 id="search-settings">Search Settings</h3>
<table>
  <tr><th>Setting</th><th>Default</th><th>Range</th><th>Description</th></tr>
  <tr><td><strong>Request Delay</strong></td><td>2000 ms</td><td>1000&ndash;10000 ms</td><td>Time between API requests. Prevents overloading Numista's servers. Lower values are faster but riskier.</td></tr>
</table>

<div class="callout callout-warning">
  <strong>Caution:</strong>
  Setting the request delay below 2000 ms may result in rate limiting from Numista.
  The default of 2000 ms (2 seconds) is recommended.
</div>

<h3 id="image-settings">Image Handling</h3>
<p>
  Images are automatically downloaded and stored in your database when you select image fields
  (<code>obverseimg</code>, <code>reverseimg</code>, <code>edgeimg</code>) during field comparison
  and click <strong>Apply Changes</strong>. Images are stored as binary data directly in the database,
  so they work offline without requiring an internet connection.
</p>

<h3 id="safety-settings">Safety &amp; Backups</h3>
<table>
  <tr><th>Setting</th><th>Default</th><th>Description</th></tr>
  <tr><td><strong>Auto-backup before changes</strong></td><td>Enabled</td><td>Creates a timestamped backup of your entire database before any data is modified.</td></tr>
  <tr><td><strong>Maximum Backups</strong></td><td>10</td><td>Number of backup files to keep. Oldest backups are automatically deleted when this limit is exceeded.</td></tr>
</table>

<h3 id="license-settings">License Management</h3>
<p>
  NumiSync Wizard offers two tiers: <strong>Free Version</strong> and <strong>Supporter Edition</strong>.
  The Free Version provides full functionality for enriching coins. The Supporter Edition unlocks
  premium features like Fast Pricing Mode and Auto-Propagate, and removes periodic license prompts.
</p>

<h4>License Tiers</h4>
<table>
  <tr><th>Feature</th><th>Free Version</th><th>Supporter Edition</th></tr>
  <tr><td>Coin enrichment (search, match, merge)</td><td>&#x2705; Full access</td><td>&#x2705; Full access</td></tr>
  <tr><td>All data types (Basic, Issue, Pricing)</td><td>&#x2705; Full access</td><td>&#x2705; Full access</td></tr>
  <tr><td>Filtering and sorting</td><td>&#x2705; Full access</td><td>&#x2705; Full access</td></tr>
  <tr><td>Fast Pricing Mode (batch updates)</td><td>&#x1F512; Locked</td><td>&#x2705; Unlocked</td></tr>
  <tr><td>Auto-Propagate (batch type data)</td><td>&#x1F512; Locked (detection free)</td><td>&#x2705; Unlocked</td></tr>
  <tr><td>License prompts</td><td>Every 20 enrichments</td><td>None</td></tr>
  <tr><td>Device limit</td><td>&mdash;</td><td>5 devices per license</td></tr>
</table>

<h4>Entering a License Key</h4>
<ol>
  <li>Open <strong>Settings</strong> &rarr; <strong>App Settings</strong> from the menu bar.</li>
  <li>Scroll to the <strong>License Management</strong> section.</li>
  <li>Enter your license key in the <strong>License Key</strong> field.</li>
  <li>Click <strong>Activate License</strong>.</li>
  <li>The application validates the key with the license server. On success, you'll see your activation details including device label and activation date.</li>
</ol>

<div class="callout callout-info">
  <strong>Device Limit:</strong>
  Each license can be activated on up to 5 devices. If you reach this limit, you'll need to deactivate
  the license on another device before activating on a new one.
</div>

<h4>License Validation</h4>
<p>
  The application periodically validates your license (every 7 days when online). If you're offline,
  the license remains valid during a grace period. The version badge in the header shows your license status:
</p>
<ul>
  <li><span class="badge badge-gray">FREE VERSION</span> &mdash; No license activated</li>
  <li><span style="background: linear-gradient(135deg, #d4af37, #f4e4ba); color: #333; padding: 2px 8px; border-radius: 3px; font-size: 12px; font-weight: 600;">Supporter Edition</span> &mdash; Valid license activated</li>
</ul>

<h4>Deactivating a License</h4>
<p>
  To transfer your license to a different device:
</p>
<ol>
  <li>Open <strong>Settings</strong> &rarr; <strong>App Settings</strong>.</li>
  <li>In the License Management section, click <strong>Deactivate</strong>.</li>
  <li>Confirm the deactivation. This frees up one device slot on your license.</li>
</ol>

<p>
  Click <strong>Save Settings</strong> to persist your changes, or <strong>Reset to Defaults</strong> to
  restore all settings to their original values.
</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="backups">13. Backups &amp; Safety</h2>

<p>
  When the auto-backup setting is enabled (recommended), the tool creates a full copy of your
  database before making any changes. Backups are stored in a <code>backups</code> folder
  located in the same directory as your database file.
</p>

<h4>Backup File Naming</h4>
<pre><code>&lt;database-name&gt;.db.backup.&lt;timestamp&gt;</code></pre>
<p>Example: <code>MyCoins.db.backup.2025-06-15T143022</code></p>

<h4>Restoring a Backup</h4>
<ol>
  <li>Close NumiSync Wizard.</li>
  <li>Navigate to the <code>backups</code> folder next to your database.</li>
  <li>Find the backup you want to restore (sorted by date).</li>
  <li>Rename or delete your current <code>.db</code> file.</li>
  <li>Rename the backup file, removing the <code>.backup.&lt;timestamp&gt;</code> suffix.</li>
  <li>Reopen the collection in NumiSync Wizard or OpenNumismat.</li>
</ol>

<div class="callout callout-danger">
  <strong>Warning:</strong>
  Disabling automatic backups means there is no safety net if something goes wrong during enrichment.
  It is strongly recommended to keep this setting enabled.
</div>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="status-bar">14. Status Bar</h2>

<p>The status bar at the bottom of the application provides real-time information:</p>
<table>
  <tr><th>Element</th><th>Description</th></tr>
  <tr><td><strong>Status Message</strong></td><td>Dynamic messages about current operations (e.g., "Searching Numista...", "Changes applied successfully").</td></tr>
  <tr><td><strong>Fetch Settings Summary</strong></td><td>Shows your current data settings (e.g., "Fetch: Basic + Pricing (3 calls)").</td></tr>
  <tr><td><strong>Session API Calls</strong></td><td>Running total of API calls made this session (e.g., "Session: 47 calls").</td></tr>
  <tr><td><strong>Progress Bar</strong></td><td>Animated bar shown during operations like loading collections or fetching data.</td></tr>
</table>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="keyboard-shortcuts">15. Menu Bar &amp; Keyboard Shortcuts</h2>

<p>
  NumiSync Wizard provides a full application menu bar with keyboard shortcuts for common actions.
  The menu adapts to your operating system (Windows or macOS) following platform conventions.
</p>

<h3 id="menu-file">File Menu</h3>
<table>
  <tr><th>Menu Item</th><th>Shortcut</th><th>Description</th></tr>
  <tr><td>Load Collection...</td><td><kbd>Ctrl</kbd>+<kbd>O</kbd></td><td>Open a file dialog to select an OpenNumismat database</td></tr>
  <tr><td>Recent Collections</td><td>&mdash;</td><td>Submenu listing recently opened collections for quick access</td></tr>
  <tr><td>Close Collection</td><td><kbd>Ctrl</kbd>+<kbd>W</kbd></td><td>Close the current collection and return to Welcome screen</td></tr>
  <tr><td>Set as Default Collection</td><td>&mdash;</td><td>Set current collection to auto-load on startup</td></tr>
  <tr><td>Clear Default Collection</td><td>&mdash;</td><td>Remove the default collection setting</td></tr>
  <tr><td>Exit</td><td><kbd>Alt</kbd>+<kbd>F4</kbd></td><td>Quit the application</td></tr>
</table>

<h3 id="menu-edit">Edit Menu</h3>
<p>These commands are available on the Field Comparison screen when selecting fields to import:</p>
<table>
  <tr><th>Menu Item</th><th>Shortcut</th><th>Description</th></tr>
  <tr><td>Select All Fields</td><td><kbd>Ctrl</kbd>+<kbd>A</kbd></td><td>Check all field checkboxes</td></tr>
  <tr><td>Select None</td><td><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>A</kbd></td><td>Uncheck all field checkboxes</td></tr>
  <tr><td>Select Empty Only</td><td>&mdash;</td><td>Check only fields where your database has no value</td></tr>
  <tr><td>Select Different Only</td><td>&mdash;</td><td>Check only fields where the Numista value differs from yours</td></tr>
</table>

<h3 id="menu-view">View Menu</h3>
<table>
  <tr><th>Menu Item</th><th>Shortcut</th><th>Description</th></tr>
  <tr><td>Filter by Status</td><td>&mdash;</td><td>Submenu to filter coins by enrichment status</td></tr>
  <tr><td>Filter by Freshness</td><td>&mdash;</td><td>Submenu to filter coins by pricing data age</td></tr>
  <tr><td>Sort By</td><td>&mdash;</td><td>Submenu to change coin list sort order</td></tr>
  <tr><td>Reset Filters</td><td>&mdash;</td><td>Clear all filters and sorting to defaults</td></tr>
  <tr><td>Refresh List</td><td><kbd>F5</kbd> or <kbd>Ctrl</kbd>+<kbd>R</kbd></td><td>Reload the coin list from the database</td></tr>
</table>

<h3 id="menu-settings">Settings Menu</h3>
<table>
  <tr><th>Menu Item</th><th>Shortcut</th><th>Description</th></tr>
  <tr><td>App Settings...</td><td><kbd>Ctrl</kbd>+<kbd>,</kbd></td><td>Open application settings (API key, backups, license)</td></tr>
  <tr><td>Data Settings...</td><td>&mdash;</td><td>Configure which data types to fetch (Basic, Issue, Pricing)</td></tr>
  <tr><td>Field Mappings...</td><td>&mdash;</td><td>Configure how Numista fields map to OpenNumismat fields</td></tr>
  <tr><td>Export Field Mappings</td><td>&mdash;</td><td>Save your field mapping configuration to a file</td></tr>
  <tr><td>Import Field Mappings</td><td>&mdash;</td><td>Load field mappings from a previously exported file</td></tr>
  <tr><td>Reset Field Mappings</td><td>&mdash;</td><td>Restore field mappings to default values</td></tr>
  <tr><td>Reset All Settings</td><td>&mdash;</td><td>Reset all settings to factory defaults</td></tr>
</table>

<h3 id="menu-help">Help Menu</h3>
<table>
  <tr><th>Menu Item</th><th>Shortcut</th><th>Description</th></tr>
  <tr><td>User Manual</td><td><kbd>F1</kbd></td><td>Open this User Manual in a new window</td></tr>
  <tr><td>Numista Website</td><td>&mdash;</td><td>Open the Numista website in your default browser</td></tr>
  <tr><td>Get Numista API Key</td><td>&mdash;</td><td>Open the Numista API page to obtain or manage your key</td></tr>
  <tr><td>View EULA</td><td>&mdash;</td><td>Display the End User License Agreement</td></tr>
  <tr><td>Purchase License Key</td><td>&mdash;</td><td>Open the purchase page (hidden for Supporter Edition users)</td></tr>
  <tr><td>About NumiSync Wizard</td><td>&mdash;</td><td>Show version, credits, and supporter status</td></tr>
</table>

<h3 id="other-shortcuts">Other Keyboard Shortcuts</h3>
<table>
  <tr><th>Key</th><th>Context</th><th>Action</th></tr>
  <tr><td><kbd>Enter</kbd></td><td>Manual Search input</td><td>Execute the search</td></tr>
  <tr><td><kbd>Escape</kbd></td><td>Modal dialogs</td><td>Close the dialog</td></tr>
</table>

<div class="callout callout-info">
  <strong>macOS Note:</strong>
  On macOS, use <kbd>Cmd</kbd> instead of <kbd>Ctrl</kbd> for all shortcuts. The menu structure
  also follows macOS conventions with an App menu containing Preferences and Quit.
</div>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="closing-collection">16. Closing a Collection</h2>

<p>
  To close the currently loaded collection, click the <strong>&larr; Close Collection</strong>
  button in the Collection Overview toolbar. This returns you to the Welcome screen.
</p>
<p>When you close a collection:</p>
<ul>
  <li>All enrichment progress that has been <strong>applied</strong> (merged) is already saved in your database and is preserved.</li>
  <li>Any in-progress work on a coin that has <strong>not yet been applied</strong> is discarded.</li>
  <li>The session API call counter resets.</li>
  <li>You can load a different collection or re-open the same one.</li>
</ul>

<div class="callout callout-info">
  <strong>Note:</strong>
  There is no "unsaved changes" warning when closing. All changes are committed to the database
  immediately when you click "Apply Changes to Coin", so there is nothing to lose by closing.
</div>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="troubleshooting">17. Troubleshooting</h2>

<h3>Common Issues</h3>

<h4>"No results found" when searching</h4>
<ul>
  <li>Try the <strong>Manual Search</strong> with different terms.</li>
  <li>Use shorter, simpler search terms (denomination + year often works well).</li>
  <li>Try searching by catalog number (e.g., "KM 23").</li>
  <li>Ensure your coin's title in OpenNumismat is not too generic or contains special characters.</li>
  <li>Common denomination spelling variants (e.g., Kopeks, Pfenning, Rouble) are automatically normalized, but very unusual spellings may not be recognized. Try using Numista&rsquo;s spelling in the manual search.</li>
</ul>

<h4>"API Key invalid" error</h4>
<ul>
  <li>Open Settings and verify your API key is entered correctly.</li>
  <li>Ensure there are no leading or trailing spaces in the key.</li>
  <li>Visit <a href="https://en.numista.com/api/" target="_blank">numista.com/api</a> to verify your key is active.</li>
</ul>

<h4>Issue matching says "No Match"</h4>
<ul>
  <li>Ensure your coin has a <strong>year</strong> recorded in OpenNumismat. Issue matching requires a year.</li>
  <li>The specific year may not exist in the Numista database for this coin type.</li>
  <li>You can still import Basic Data even if issue matching fails.</li>
</ul>

<h4>Pricing data returns empty</h4>
<ul>
  <li>Not all coins in the Numista database have pricing data.</li>
  <li>Try a different currency &mdash; pricing availability varies by currency.</li>
  <li>Modern common coins and very rare coins may lack market pricing data.</li>
</ul>

<h4>Images not appearing in OpenNumismat</h4>
<ul>
  <li>Make sure you selected the image fields (obverseimg, reverseimg, edgeimg) and clicked <strong>Apply Changes</strong>.</li>
  <li>Images are stored directly in the database and should appear immediately after enrichment.</li>
  <li>Some coin types on Numista do not have images available &mdash; check if Numista showed a placeholder during field comparison.</li>
  <li>Close and reopen your collection in OpenNumismat to refresh the image cache.</li>
</ul>

<h4>Database file appears locked</h4>
<ul>
  <li>Close OpenNumismat before loading the collection in NumiSync Wizard.</li>
  <li>Only one application should access the <code>.db</code> file at a time.</li>
</ul>

<h4>Application seems slow</h4>
<ul>
  <li>The request delay (default 2000 ms) means each API call waits 2 seconds. This is intentional to respect Numista's servers.</li>
  <li>Loading very large collections (5,000+ coins) may take a moment. The progress bar shows loading status.</li>
</ul>

<h4>License activation fails with "device limit reached"</h4>
<ul>
  <li>Each license can be activated on up to 5 devices.</li>
  <li>To activate on a new device, deactivate the license from one of your existing devices first.</li>
  <li>Open App Settings on an existing device, find the License Management section, and click <strong>Deactivate</strong>.</li>
</ul>

<h4>Fast Pricing Mode button shows a lock icon</h4>
<ul>
  <li>Fast Pricing Mode is a premium feature that requires a Supporter Edition license.</li>
  <li>The lock icon indicates the feature is gated. Click it to see the license prompt.</li>
  <li>You can still update pricing for individual coins by clicking on them and re-applying changes with Pricing Data enabled.</li>
</ul>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="getting-help">18. Getting Help</h2>

<h3>Report an Issue</h3>
<p>If you encounter a bug or unexpected behavior:</p>
<ol>
  <li>Open <strong>Help &rarr; Report an Issue</strong> from the menu bar.</li>
  <li>Check the <a href="#troubleshooting">Troubleshooting</a> section to see if your
      issue is already covered.</li>
  <li>If not, click <strong>Open GitHub Issues</strong> to search for existing reports
      or create a new one.</li>
</ol>

<h3>Including Log Files</h3>
<p>Log files help diagnose issues by recording what the application was doing when a
   problem occurred. To provide a useful log:</p>
<ol>
  <li>Go to <strong>Settings &rarr; Logging</strong> and set the log level to
      <strong>Debug</strong>.</li>
  <li>Reproduce the issue (perform the action that caused the problem).</li>
  <li>Click <strong>Download Log File</strong> in Settings, or use
      <strong>Help &rarr; Report an Issue &rarr; Download Log File</strong>.</li>
  <li>Attach the downloaded <code>.log</code> file to your GitHub issue.</li>
  <li>Set the log level back to <strong>Info</strong> for normal use.</li>
</ol>

<div class="callout-info">
  <strong>Privacy:</strong> Log files contain technical details about application operations
  (API calls, database operations, error messages) but do not contain your personal data,
  API keys, or collection content. You can open the .log file in any text editor to review
  its contents before sharing.
</div>

<h3>Resources</h3>
<table>
  <tr><th>Resource</th><th>Description</th></tr>
  <tr>
    <td><a href="https://github.com/inguy24/Numisync-Wizard/issues" target="_blank">GitHub Issues</a></td>
    <td>Report bugs, request features, or search existing issues</td>
  </tr>
  <tr>
    <td><a href="https://en.numista.com/api/" target="_blank">Numista API Dashboard</a></td>
    <td>Check your API key status and monthly usage</td>
  </tr>
</table>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="faq">19. Frequently Asked Questions</h2>

<h4>Is the Numista API free?</h4>
<p>Yes. Numista provides free API access for personal use. You just need to create a free account and generate an API key.</p>

<h4>Will this tool modify my OpenNumismat data?</h4>
<p>Only when you explicitly click "Apply Changes to Coin" and only for the fields you select. An automatic backup is created before any changes (if enabled). No data is ever overwritten without your approval.</p>

<h4>Can I undo changes?</h4>
<p>Yes. Restore from the automatic backup created before the changes were made (see <a href="#backups">Backups &amp; Safety</a>).</p>

<h4>Can I use this tool with multiple collections?</h4>
<p>Yes. Close the current collection and load a different <code>.db</code> file. Each collection has its own settings file.</p>

<h4>How is my progress saved?</h4>
<p>Progress is stored as invisible metadata inside each coin's notes field in your database. This means your progress travels with the database file and survives application reinstalls.</p>

<h4>Can I enrich the same coin again?</h4>
<p>Yes. You can click on any previously enriched coin to search again, select a different match, or import additional fields.</p>

<h4>Do I need to be online?</h4>
<p>Yes, an internet connection is required to search Numista and fetch data. However, once data has been merged into your database, it is stored locally and available offline.</p>

<h4>How many API calls do I get?</h4>
<p>The Numista API has generous limits for personal use. The tool displays your session call count in the status bar so you can monitor usage. Each coin costs 2&ndash;4 API calls depending on your data settings.</p>

<h4>What happens if I lose internet mid-session?</h4>
<p>Any data already merged into your database is saved. Coins in progress when the connection dropped will show an "Error" status. You can retry them when your connection is restored.</p>

<h4>Does this tool upload my data anywhere?</h4>
<p>No. The tool only <em>reads</em> from Numista. It never uploads your collection data, personal information, or any other data to external servers.</p>

<h4>What if I move my database file to a different folder or computer?</h4>
<p>Copy the settings file (<code>&lt;database&gt;_settings.json</code>) alongside your <code>.db</code> file. Your enrichment progress is stored inside the database itself (in the coin notes), so it travels automatically. The settings file contains your API key and preferences.</p>

<h4>Can I change the number of coins shown per page?</h4>
<p>The page size is fixed at 100 coins per page and is not currently configurable.</p>

<h4>Do I need to purchase a license to use this tool?</h4>
<p>No. The Free Version provides full functionality for enriching coins. The Supporter Edition is optional and unlocks premium features like Fast Pricing Mode while removing periodic license prompts. See <a href="#license-settings">License Management</a> for details.</p>

<h4>What features require a license?</h4>
<p>Premium features include <strong>Fast Pricing Mode</strong> (batch pricing updates) and <strong>Auto-Propagate</strong> (batch type data propagation). All core enrichment functionality &mdash; searching, matching, comparing, and merging data &mdash; is available in the Free Version. Note: Auto-Propagate detection is free; only applying to multiple coins requires a license.</p>

<h4>How many devices can I use with one license?</h4>
<p>Each license can be activated on up to 5 devices. You can deactivate a device to free up a slot for a new one. See <a href="#license-settings">License Management</a> for instructions.</p>

<h4>What happens if I reach the device limit?</h4>
<p>You'll see an error when trying to activate. To activate on a new device, first deactivate the license from one of your existing devices via App Settings.</p>

<h4>Does the license expire?</h4>
<p>The license covers the current major version and all updates within that version. Future major versions may require a discounted upgrade. The license remains valid offline for a grace period after the last successful validation.</p>

<h4>What if I lose my license key?</h4>
<p>Contact support with your purchase information. Your license key is associated with your email address from the original purchase.</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="api-cache-usage">20. API Cache &amp; Usage Tracking</h2>

<h3 id="cache-overview">Cache Overview</h3>

<p>NumiSync Wizard caches Numista API responses locally on disk to reduce API calls across sessions. When you look up a coin type or fetch issuer data, the response is saved so that future requests for the same data can be served from the local cache instead of making another API call.</p>

<p>The following data types are cached persistently (surviving app restarts):</p>

<table>
  <tr><th>Data Type</th><th>Default TTL</th><th>Description</th></tr>
  <tr><td>Issuers (countries)</td><td>90 days</td><td>The full list of Numista issuing authorities. Rarely changes.</td></tr>
  <tr><td>Type data (coin specs)</td><td>30 days</td><td>Detailed coin type information (composition, rulers, references, etc.).</td></tr>
  <tr><td>Issue data (mintage, mintmarks)</td><td>30 days</td><td>Year/mint/mintage variants for a coin type.</td></tr>
</table>

<p>The following are <strong>not</strong> cached persistently:</p>
<table>
  <tr><th>Data Type</th><th>Reason</th></tr>
  <tr><td>Search results</td><td>Searches are situational and vary by query; cached per session only.</td></tr>
  <tr><td>Pricing data</td><td>Prices change frequently; freshness is the whole point of fetching them.</td></tr>
</table>

<p>The cache file (<code>numista_api_cache.json</code>) is stored in the application data directory and is shared across all collections, since issuer/type/issue data is global Numista catalog data.</p>

<h3 id="cache-settings">Cache Settings</h3>

<p>You can configure cache durations in <strong>Settings &rarr; API Cache</strong>:</p>

<table>
  <tr><th>Setting</th><th>Options</th><th>Description</th></tr>
  <tr><td>Issuers TTL</td><td>No caching, 30&ndash;360 days</td><td>How long to keep the issuers (countries) list cached. The issuers list rarely changes, so longer durations are safe.</td></tr>
  <tr><td>Type Data TTL</td><td>No caching, 30&ndash;360 days</td><td>How long to keep coin type details cached.</td></tr>
  <tr><td>Issue Data TTL</td><td>No caching, 30&ndash;360 days</td><td>How long to keep issue (mintage/mintmark) data cached.</td></tr>
  <tr><td>Monthly API Call Limit</td><td>100&ndash;100,000</td><td>Your Numista API monthly quota. Free accounts have 2,000 calls/month.</td></tr>
  <tr><td>Current Month Usage</td><td>Editable number</td><td>Locally tracked API call count. Adjust manually to match your Numista dashboard if needed.</td></tr>
  <tr><td>Clear API Cache</td><td>Button</td><td>Wipes all cached data. Monthly usage tracking is preserved.</td></tr>
</table>

<div class="callout-info">
  <strong>Tip:</strong> Setting any TTL to &ldquo;No caching&rdquo; means that data type will always be fetched fresh from the API. This uses more quota but ensures you always have the latest data.
</div>

<h3 id="monthly-usage">Monthly Usage Tracking</h3>

<p>The status bar at the bottom of the window shows your monthly API usage alongside the session counter:</p>

<p><code>Fetch: Basic (2 calls) &bull; Session: 12 &bull; Month: 825/2,000</code></p>

<p>The monthly counter tracks how many API calls have been made in the current calendar month. It resets automatically at the start of each new month. The counter changes color as you approach your limit:</p>

<table>
  <tr><th>Usage Level</th><th>Color</th></tr>
  <tr><td>Below 75%</td><td>Default (normal text color)</td></tr>
  <tr><td>75% &ndash; 90%</td><td>Orange/yellow (warning)</td></tr>
  <tr><td>Above 90%</td><td>Red (critical)</td></tr>
</table>

<div class="callout-warning">
  <strong>Important:</strong> Usage is tracked locally and only counts API calls made by this application. If you use the same API key with other tools, the local count may not match your actual Numista usage. Use the Numista dashboard link in Settings to verify.
</div>

<h3 id="numista-quota">Numista API Quota</h3>

<p>Numista free accounts have a <strong>2,000 API call/month</strong> limit. The following operations each count as one API call:</p>

<table>
  <tr><th>Operation</th><th>API Endpoint</th><th>Calls</th></tr>
  <tr><td>Search for coin types</td><td><code>searchTypes</code></td><td>1 per search attempt</td></tr>
  <tr><td>Get coin type details</td><td><code>getType</code></td><td>1 per type</td></tr>
  <tr><td>Get issue data (years/mints)</td><td><code>getIssues</code></td><td>1 per type</td></tr>
  <tr><td>Get pricing data</td><td><code>getPrices</code></td><td>1 per issue</td></tr>
  <tr><td>Get issuers list</td><td><code>getIssuers</code></td><td>1 (cached for extended periods)</td></tr>
</table>

<p>A typical enrichment with Basic + Issue + Pricing data costs <strong>4 API calls</strong> per coin (1 search + 1 type + 1 issues + 1 pricing). The persistent cache significantly reduces this for repeated lookups &mdash; if you enrich the same coin type again (or a different coin of the same type), the type and issue data come from cache at zero API cost.</p>

<p>To check your actual server-side usage, visit the <a href="https://en.numista.com/api/dashboard.php" target="_blank">Numista API Dashboard</a>. You can also access this link from <strong>Settings &rarr; API Cache</strong>.</p>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="appendix-fields">Appendix A: Field Reference</h2>

<p>The following table lists all fields that can be imported from Numista into your OpenNumismat database:</p>

<h4>Basic Data Fields</h4>
<table>
  <tr><th>Field</th><th>Description</th></tr>
  <tr><td>Title</td><td>Official name of the coin type</td></tr>
  <tr><td>Category</td><td>Classification (e.g., coin, token, medal)</td></tr>
  <tr><td>Series</td><td>Series name if part of a set</td></tr>
  <tr><td>Country</td><td>Issuing country or authority</td></tr>
  <tr><td>Period</td><td>Historical period</td></tr>
  <tr><td>Ruler</td><td>Monarch or head of state (if applicable)</td></tr>
  <tr><td>Type</td><td>Coin type designation</td></tr>
  <tr><td>Value</td><td>Face value (numeric)</td></tr>
  <tr><td>Unit</td><td>Currency unit (e.g., Cents, Pence)</td></tr>
  <tr><td>Composition / Material</td><td>Metal composition (e.g., Silver .925, Copper-Nickel)</td></tr>
  <tr><td>Weight</td><td>Weight in grams</td></tr>
  <tr><td>Diameter</td><td>Diameter in millimeters</td></tr>
  <tr><td>Thickness</td><td>Thickness in millimeters</td></tr>
  <tr><td>Shape</td><td>Coin shape (e.g., Round, Heptagonal)</td></tr>
  <tr><td>Orientation</td><td>Die orientation (medal or coin alignment)</td></tr>
  <tr><td>Technique</td><td>Minting technique (e.g., Milled, Cast)</td></tr>
  <tr><td>Obverse Description</td><td>Description of the obverse (heads) design</td></tr>
  <tr><td>Reverse Description</td><td>Description of the reverse (tails) design</td></tr>
  <tr><td>Edge Description</td><td>Description of the edge (e.g., Reeded, Plain)</td></tr>
  <tr><td>Edge Lettering</td><td>Text inscribed on the edge</td></tr>
  <tr><td>Catalog Numbers</td><td>Standard references (KM, Sch&ouml;n, Y, etc.)</td></tr>
  <tr><td>Tags</td><td>Descriptive tags from Numista</td></tr>
</table>

<h4>Issue Data Fields</h4>
<table>
  <tr><th>Field</th><th>Description</th></tr>
  <tr><td>Mintmark</td><td>Mint identification letter or symbol</td></tr>
  <tr><td>Mintage</td><td>Number of coins struck for this issue</td></tr>
  <tr><td>Comment</td><td>Additional issue information (e.g., "Proof", "Restrike")</td></tr>
</table>

<h4>Pricing Data Fields</h4>
<table>
  <tr><th>Field</th><th>Description</th></tr>
  <tr><td>Price (UNC)</td><td>Market value in Uncirculated grade</td></tr>
  <tr><td>Price (XF)</td><td>Market value in Extremely Fine grade</td></tr>
  <tr><td>Price (VF)</td><td>Market value in Very Fine grade</td></tr>
  <tr><td>Price (Fine)</td><td>Market value in Fine grade</td></tr>
</table>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<!-- ──────────────────────────────────────────────────────────────────────── -->
<h2 id="appendix-statuses">Appendix B: Status Reference</h2>

<h4>Per-Data-Type Statuses</h4>
<table>
  <tr><th>Status</th><th>Icon</th><th>Meaning</th></tr>
  <tr><td>MERGED</td><td>&#x2705;</td><td>Data was successfully fetched and written to the database.</td></tr>
  <tr><td>NOT_QUERIED</td><td>&#x26AA;</td><td>User did not request this data type in settings.</td></tr>
  <tr><td>PENDING</td><td>&#x23F3;</td><td>Data fetch is currently in progress.</td></tr>
  <tr><td>ERROR</td><td>&#x274C;</td><td>API call failed (network error, server error, etc.).</td></tr>
  <tr><td>NO_MATCH</td><td>&#x2753;</td><td>Issue matching failed &mdash; no issue found for this coin's year. (Issue data only.)</td></tr>
  <tr><td>NO_DATA</td><td>&#x1F4ED;</td><td>API returned successfully but with no data for this field.</td></tr>
  <tr><td>SKIPPED</td><td>&#x1F6AB;</td><td>User explicitly chose to skip this data type for this coin.</td></tr>
</table>

<h4>Overall Coin Statuses</h4>
<table>
  <tr><th>Status</th><th>Meaning</th></tr>
  <tr><td>COMPLETE</td><td>All requested data types have status MERGED.</td></tr>
  <tr><td>PARTIAL</td><td>At least one data type is MERGED, but others are not.</td></tr>
  <tr><td>PENDING</td><td>Coin has not been processed by the user yet.</td></tr>
  <tr><td>SKIPPED</td><td>User chose to skip this coin entirely (no data types fetched).</td></tr>
  <tr><td>ERROR</td><td>A critical error prevented processing.</td></tr>
</table>

<a href="#introduction" class="back-to-top">Back to top &uarr;</a>

<hr>

<p style="text-align: center; color: var(--text-light); font-size: 13px; margin-top: 40px;">
  NumiSync Wizard for OpenNumismat &mdash; User Manual v1.1<br>
  For issues and feedback, please visit the project repository.
</p>

</div><!-- /.main-content -->

<!-- ── Smooth scrolling & active sidebar link highlighting ── -->
<script>
  // Smooth scrolling for all anchor links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({ behavior: 'smooth' });
        // Close mobile sidebar
        document.querySelector('.sidebar').classList.remove('open');
      }
    });
  });

  // Highlight active sidebar link on scroll
  const sections = document.querySelectorAll('h2[id], h3[id]');
  const navLinks = document.querySelectorAll('.sidebar a');

  window.addEventListener('scroll', () => {
    let current = '';
    sections.forEach(section => {
      const sectionTop = section.offsetTop;
      if (window.pageYOffset >= sectionTop - 60) {
        current = section.getAttribute('id');
      }
    });

    navLinks.forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('href') === '#' + current) {
        link.classList.add('active');
      }
    });
  });
</script>

</body>
</html>
